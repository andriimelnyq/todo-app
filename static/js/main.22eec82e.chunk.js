(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{45:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var r=n(33),a=n(15),o=(n(43),n(44),n(45),n(3)),c=n(5),s=n(0),i=n.n(s),l=n(4),d=n(6),u="https://mate.academy/students-api";function j(e){var t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET"};return n&&(r.body=JSON.stringify(n),r.headers={"Content-Type":"application/json; charset=UTF-8"}),(t=300,new Promise((function(e){setTimeout(e,t)}))).then((function(){return fetch(u+e,r)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var b,p=function(e){return j(e)},m=function(e,t){return j(e,"POST",t)},O=function(e,t){return j(e,"PATCH",t)},f=function(e){return j(e,"DELETE")},h=function(e){return f("/todos/".concat(e))},x=function(e,t){return O("/todos/".concat(e),t)};!function(e){e.ADD="Unable to add a todo",e.DELETE="Unable to delete a todo",e.DELETE_COMPLETED="Unable to delete completed todos",e.UPDATE="Unable to update a todo",e.LOAD="Unable to load a todo",e.NONE=""}(b||(b={}));var v=n(7),T=n.n(v),g=function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){var n;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){var n,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.name,e.abrupt("return",m("/users",{email:n,name:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=n(1),y=i.a.memo((function(e){var t=e.loading,n=e.needToRegister,r=e.errorMessage,a=e.email,o=e.name,c=e.setEmail,s=e.setName;return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(k.jsxs)("div",{className:T()("control has-icons-left",{"is-loading":t}),children:[Object(k.jsx)("input",{type:"email",id:"user-email",className:T()("input",{"is-danger":!n&&r}),placeholder:"Enter your email",disabled:t||n,value:a,required:!0,onChange:function(e){return c(e.target.value)}}),Object(k.jsx)("span",{className:"icon is-small is-left",children:Object(k.jsx)("i",{className:"fas fa-envelope"})})]}),!n&&r&&Object(k.jsx)("p",{className:"help is-danger",children:r})]}),n&&Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(k.jsxs)("div",{className:T()("control has-icons-left",{"is-loading":t}),children:[Object(k.jsx)("input",{type:"text",id:"user-name",className:T()("input",{"is-danger":n&&r}),placeholder:"Enter your name",required:!0,minLength:4,disabled:t,value:o,onChange:function(e){return s(e.target.value)}}),Object(k.jsx)("span",{className:"icon is-small is-left",children:Object(k.jsx)("i",{className:"fas fa-user"})})]}),n&&r&&Object(k.jsx)("p",{className:"help is-danger",children:r})]})]})})),w=function(e){var t=e.onLogin,n=Object(s.useState)(""),r=Object(c.a)(n,2),a=r[0],o=r[1],i=Object(s.useState)(""),u=Object(c.a)(i,2),j=u[0],b=u[1],p=Object(s.useState)(!1),m=Object(c.a)(p,2),O=m[0],f=m[1],h=Object(s.useState)(!1),x=Object(c.a)(h,2),v=x[0],w=x[1],E=Object(s.useState)(""),C=Object(c.a)(E,2),_=C[0],S=C[1],A=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(s.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(r){S("Need to login!")}}),[]);var D=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var t;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(a);case 2:(t=e.sent)?A(t):f(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),S(""),w(!0),e.prev=3,!O){e.next=9;break}return e.next=7,N({name:j,email:a}).then(A);case 7:e.next=11;break;case 9:return e.next=11,D();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),S("Something went wrtong");case 16:return e.prev=16,w(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)("form",{onSubmit:L,className:"box mt-5",children:[Object(k.jsx)("h1",{className:"title is-3",children:O?"You need to register":"Log in to open todos"}),Object(k.jsx)(y,{loading:v,needToRegister:O,errorMessage:_,email:a,name:j,setEmail:o,setName:b}),Object(k.jsx)("div",{className:"field",children:Object(k.jsx)("button",{type:"submit",className:T()("button is-primary",{"is-loading":v}),children:O?"Register":"Login"})})]})},E=i.a.createContext(null),C=function(e){var t=e.children,n=Object(s.useState)(null),r=Object(c.a)(n,2),a=r[0],o=r[1];return a?Object(k.jsx)(E.Provider,{value:a,children:t}):Object(k.jsx)(w,{onLogin:o})},_=n(34),S=function(e){var t=e.todosFromServer,n=e.newTodoTitle,r=e.setNewTodoTitle,a=e.createTodo,o=e.toggleAllTodos,c=e.setAppliedNewTodoTitle,i=e.activeTodosCount,l=e.isAdding,d=Object(s.useRef)(null),u=Object(s.useCallback)(Object(_.debounce)(c,1e3),[]);return Object(s.useEffect)((function(){d.current&&d.current.focus()}),[t]),Object(k.jsxs)("header",{className:"todoapp__header",children:[Object(k.jsx)("button",{"data-cy":"ToggleAllButton",type:"button","aria-label":"Toggle all button",className:T()("todoapp__toggle-all",{active:0===i},{hidden:0===t.length}),onClick:o}),Object(k.jsx)("form",{onSubmit:a,children:Object(k.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:d,className:"todoapp__new-todo",placeholder:"What needs to be done?",value:n,disabled:l,onChange:function(e){r(e.target.value),u(e.target.value)}})})]})},A=n(51),D=n(50),L=i.a.memo((function(e){var t=e.todo,n=e.isAdding,r=e.removeTodo,a=e.toggleTodo,o=e.updateTodoTitle,i=e.todoIdsForLoader,l=Object(s.useState)(t.title),d=Object(c.a)(l,2),u=d[0],j=d[1],b=Object(s.useState)(!1),p=Object(c.a)(b,2),m=p[0],O=p[1],f=Object(s.useRef)(null);Object(s.useEffect)((function(){f.current&&f.current.focus()}));return Object(k.jsxs)("div",{"data-cy":"Todo",className:t.completed?"todo completed":"todo",children:[Object(k.jsx)("label",{className:"todo__status-label",children:Object(k.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",onChange:function(){return a(t)}})}),Object(k.jsx)("span",{"data-cy":"TodoTitle",className:T()("todo__title",{hidden:m}),onDoubleClick:function(){return O(!0)},children:u}),Object(k.jsx)("button",{type:"button",className:T()("todo__remove",{hidden:m}),"data-cy":"TodoDeleteButton",onClick:function(){return r(t.id)},children:"\xd7"}),Object(k.jsx)("form",{onSubmit:function(e){switch(e.preventDefault(),u){case"":return void r(t.id);case t.title:return void O(!1)}o(u,t),O(!1)},children:Object(k.jsx)("input",{"data-cy":"TodoTitleField",type:"text",className:T()("todo__title-field",{hidden:!m}),placeholder:"Empty todo will be deleted",value:u,ref:f,onChange:function(e){return j(e.target.value)},onBlur:function(){return o(u,t)},onKeyDown:function(e){"Escape"===e.key&&(O(!1),j(t.title))}})}),Object(k.jsxs)("div",{"data-cy":"TodoLoader",className:T()("modal","overlay",{"is-active":n||i.includes(t.id)}),children:[Object(k.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(k.jsx)("div",{className:"loader"})]})]},t.id)})),F=i.a.memo((function(e){var t=e.todos,n=e.isAdding,r=e.newTodoTitle,a=e.removeTodo,o=e.toggleTodo,c=e.updateTodoTitle,s=e.todoIdsForLoader;return Object(k.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:Object(k.jsxs)(A.a,{children:[t.map((function(e){return Object(k.jsx)(D.a,{timeout:300,classNames:"item",children:Object(k.jsx)(L,{todo:e,isAdding:!1,removeTodo:a,toggleTodo:o,updateTodoTitle:c,todoIdsForLoader:s})},e.id)})),n&&Object(k.jsx)(D.a,{timeout:300,classNames:"item",children:Object(k.jsx)(L,{todo:{id:0,userId:0,title:r,completed:!1},isAdding:n,removeTodo:a,toggleTodo:o,updateTodoTitle:c,todoIdsForLoader:s})},0)]})})})),P=function(e){var t=e.to,n=e.text;return Object(k.jsx)(a.b,{"data-cy":"FilterLinkAll",end:!0,to:t,className:function(e){var t=e.isActive;return T()("filter__link",{selected:t})},children:n})},I=function(){return Object(k.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(k.jsx)(P,{to:"/",text:"All"}),Object(k.jsx)(P,{to:"/active",text:"Active"}),Object(k.jsx)(P,{to:"/completed",text:"Completed"})]})},U=i.a.memo((function(e){var t=e.todosFromServer,n=e.activeTodosCount,r=e.clearCompletedTodos,a=t.length-n;return Object(k.jsxs)("footer",{className:T()("todoapp__footer",{hidden:0===t.length}),"data-cy":"Footer",children:[Object(k.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(n," items left")}),Object(k.jsx)(I,{}),Object(k.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:T()("todoapp__clear-completed",{hidden:0===a}),onClick:r,children:"Clear completed"})]})})),B=i.a.memo((function(e){var t=e.error,n=e.setError;return setTimeout((function(){return n(b.NONE)}),3e3),Object(k.jsxs)("div",{"data-cy":"ErrorNotification",className:T()("notification","is-danger","is-light","has-text-weight-normal",{hidden:t===b.NONE}),children:[Object(k.jsx)("button",{"aria-label":"Delete error","data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){return n(b.NONE)}}),t]})})),R=i.a.memo((function(){var e=Object(s.useContext)(E),t=Object(s.useState)(""),n=Object(c.a)(t,2),r=n[0],a=n[1],i=Object(o.o)().status,u=function(){var e=Object(s.useContext)(E),t=Object(s.useState)(b.NONE),n=Object(c.a)(t,2),r=n[0],a=n[1],o=Object(s.useState)([]),i=Object(c.a)(o,2),u=i[0],j=i[1],O=Object(s.useState)(""),f=Object(c.a)(O,2),v=f[0],T=f[1],g=Object(s.useState)(!1),N=Object(c.a)(g,2),k=N[0],y=N[1],w=Object(s.useState)([]),C=Object(c.a)(w,2),_=C[0],S=C[1],A=Object(s.useCallback)(Object(d.a)(Object(l.a)().mark((function t(){var n;return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=12;break}return t.prev=1,a(b.NONE),t.next=5,r=e.id,p("/todos?userId=".concat(r));case 5:n=t.sent,j(n),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),a(b.LOAD);case 12:case"end":return t.stop()}var r}),t,null,[[1,9]])}))),[e]),D=Object(s.useCallback)(function(){var t=Object(d.a)(Object(l.a)().mark((function t(n){return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),!e||!v.trim().length){t.next=19;break}return t.prev=2,y(!0),t.next=6,r=e.id,m("/todos",{userId:r,title:v,completed:!1});case 6:return t.next=8,A();case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),a(b.ADD);case 13:return t.prev=13,y(!1),T(""),t.finish(13);case 17:t.next=20;break;case 19:a(b.ADD);case 20:case"end":return t.stop()}var r}),t,null,[[2,10,13,17]])})));return function(e){return t.apply(this,arguments)}}(),[e,v]),L=Object(s.useCallback)(Object(d.a)(Object(l.a)().mark((function e(){var t,n;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=u.filter((function(e){return!e.completed})).map((function(e){return e.id}))).length){e.next=10;break}return S(t),e.next=6,Promise.all(t.map((function(e){return x(e,{completed:!0})})));case 6:return e.next=8,A();case 8:e.next=16;break;case 10:return n=u.map((function(e){return e.id})),S(n),e.next=14,Promise.all(u.map((function(e){return x(e.id,{completed:!1})})));case 14:return e.next=16,A();case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),a(b.UPDATE);case 21:return e.prev=21,S([]),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[0,18,21,24]])}))),[u]),F=Object(s.useCallback)(Object(d.a)(Object(l.a)().mark((function e(){var t;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=u.filter((function(e){return e.completed})).map((function(e){return e.id})),S(t),e.next=5,Promise.all(t.map((function(e){return h(e)})));case 5:return e.next=7,A();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),a(b.DELETE_COMPLETED);case 12:return e.prev=12,S([]),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))),[u]),P=Object(s.useCallback)(function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,S([t]),e.next=4,h(t);case 4:return e.next=6,A();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a(b.DELETE);case 11:return e.prev=11,S([]),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),[u]),I=Object(s.useCallback)(function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,S([t.id]),e.next=4,x(t.id,{completed:!t.completed});case 4:return e.next=6,A();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a(b.UPDATE);case 11:return e.prev=11,S([]),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),[u]),U=Object(s.useCallback)(function(){var e=Object(d.a)(Object(l.a)().mark((function e(t,n){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,S([n.id]),e.next=4,x(n.id,{title:t});case 4:return e.next=6,A();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a(b.UPDATE);case 11:return e.prev=11,S([]),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t,n){return e.apply(this,arguments)}}(),[u]);return{error:r,setError:a,todosFromServer:u,newTodoTitle:v,setNewTodoTitle:T,isAdding:k,todoIdsForLoader:_,loadTodos:A,createTodo:D,toggleAllTodos:L,clearCompletedTodos:F,toggleTodo:I,updateTodoTitle:U,removeTodo:P}}(),j=u.error,O=u.setError,f=u.todosFromServer,v=u.newTodoTitle,T=u.setNewTodoTitle,g=u.isAdding,N=u.loadTodos,y=u.createTodo,w=u.toggleAllTodos,C=u.clearCompletedTodos,_=u.removeTodo,A=u.toggleTodo,D=u.updateTodoTitle,L=u.todoIdsForLoader;Object(s.useEffect)((function(){N()}),[e]);var P=Object(s.useMemo)((function(){return f.filter((function(e){switch(i){case"completed":return e.completed;case"active":return!e.completed;default:return e}}))}),[f,i]),I=f.reduce((function(e,t){return(t.completed?0:1)+e}),0);return Object(k.jsxs)("div",{className:"todoapp",children:[Object(k.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(k.jsxs)("div",{className:"todoapp__content",children:[Object(k.jsx)(S,{todosFromServer:f,newTodoTitle:v,setNewTodoTitle:T,createTodo:y,toggleAllTodos:w,setAppliedNewTodoTitle:a,activeTodosCount:I,isAdding:g}),Object(k.jsx)(F,{todos:P,isAdding:g,newTodoTitle:r,removeTodo:_,toggleTodo:A,updateTodoTitle:D,todoIdsForLoader:L}),Object(k.jsx)(U,{todosFromServer:f,activeTodosCount:I,clearCompletedTodos:C})]}),Object(k.jsx)(B,{error:j,setError:O})]})})),J=function(){return Object(k.jsx)("h1",{className:"todoapp__title",children:"Page not found"})},M=function(){var e=Object(o.k)().pathname,t="/active"===e||"/completed"===e;return Object(k.jsx)(C,{children:Object(k.jsxs)(o.c,{children:[Object(k.jsx)(o.a,{path:"/",element:Object(k.jsx)(R,{})}),t&&Object(k.jsx)(o.a,{path:":status",element:Object(k.jsx)(R,{})}),Object(k.jsx)(o.a,{path:"*",element:Object(k.jsx)(J,{})})]})})},q=function(){return Object(k.jsx)(a.a,{children:Object(k.jsx)(M,{})})};Object(r.createRoot)(document.getElementById("root")).render(Object(k.jsx)(q,{}))}},[[48,1,2]]]);
//# sourceMappingURL=main.22eec82e.chunk.js.map